{{$availableScopes := widget_available_scopes}}
{{$scopes := .Result.Scopes}}
{{$result := .Result.Widget}}
{{$resource := .Resource}}

<div class="qor-layout__tabs">
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header qor-layout__tabs-container">

    {{if $availableScopes}}
      {{$widget_scope := .Context.Request.URL.Query.Get "widget_scope"}}

      <header class="mdl-layout__header qor-layout__tabs-header">
        <div class="mdl-layout__tab-bar mdl-js-ripple-effect">
          {{range $availableScope := $availableScopes}}
            <a  href="#scroll-tab-1"
                class="mdl-layout__tab{{if eq $widget_scope $availableScope.ToParam}} is-active{{end}}{{if (is_included $scopes $availableScope.ToParam)}} available{{end}}"
                data-url="{{url_for $result $resource}}?widget_scope={{$availableScope.ToParam}}"
                data-name="{{$availableScope.ToParam}}">
                {{$availableScope.Name}}
            </a>
          {{end}}
        </div>
      </header>
    {{end}}

    <main class="mdl-layout__content qor-layout__tabs-content">
      <section class="">

        <div class="page-content">
          {{$actions := load_actions "edit"}}
          {{if $actions}}
            <div class="qor-page__header">{{$actions}}</div>
          {{end}}

          <div class="qor-page__body qor-page__edit">
            {{render "shared/flashes"}}
            {{render "shared/errors"}}

            <div class="qor-form-container">
              <form class="qor-form" action="{{url_for $result $resource}}" method="POST" enctype="multipart/form-data">
                <input name="_method" value="PUT" type="hidden">

                {{render_form $result edit_sections}}

                {{if has_update_permission $resource}}
                  <div class="qor-form__actions">
                    <button class="mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect qor-button--save" type="submit">{{t "qor_admin.form.save_changes" "Save Changes"}}</button>
                    <a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect qor-button--cancel" href="javascript:history.back();">{{t "qor_admin.form.cancel_edit" "Cancel Edit"}}</a>
                  </div>
                {{end}}
              </form>
            </div>
          </div>
        </div>

      </section>
    </main>

  </div>
</div>